(function(){"use strict";var e={2462:function(e,t,i){var o=i(144),r=i(998),n=i(3059),l=function(){var e=this,t=e._self._c;return t(r.Z,[t("top-bar"),t(n.Z,[t("router-view")],1)],1)},s=[],a=i(8345),u=i(5174),c=i(6321),d=i(3687),p=i(7953),f=function(){var e=this,t=e._self._c;return t(u.Z,{attrs:{app:"",color:"primary",dark:""}},[e._t("nav"),t("div",{staticClass:"d-flex align-center"},[t(c.Z,{staticClass:"shrink mr-2",attrs:{alt:"Vue logo",contain:"",src:i(9574),transition:"scale-transition",width:"35"}}),t(p.qW,{staticClass:"text-h6 text-md-h4 text-xl-h3"},[e._v("Vue cloud storage")])],1),t(d.Z),t("user-menu")],2)},h=[],m=i(903),g=i(4145),v=i(4886),w=i(9223),_=i(4324),y=i(5808),b=i(4525),x=i(8627),Z=i(7912),k=i(4611),F=i(4568),S=i(2540),D=function(){var e=this,t=e._self._c;return t(F.Z,{attrs:{left:"","offset-x":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:o}){return[t(m.Z,e._g(e._b({attrs:{icon:""}},"v-btn",o,!1),i),[t(_.Z,{attrs:{"aria-hidden":"false"}},[e._v(" "+e._s(e.authStore.isAuthorized?"mdi-account":"mdi-login-variant")+" ")])],1)]}}])},[t(g.Z,[t(v.EB,[e._v(" "+e._s(e.authStore.isAuthorized?"Profile":"Authorization")+" ")]),t(v.ZB,[t(y.Z,{attrs:{subheader:""}},[t(S.Z,[e._v("Info")]),e.authStore.isAuthorized?e._l(e.authStore.user,(function(i,o){return t(b.Z,{key:o},[void 0===i.displayable||!0===i.displayable?t(x.km,[t(x.V9,{domProps:{textContent:e._s(i.label)}}),t(x.oZ,{domProps:{textContent:e._s(void 0!==i.formatter?i.formatter(i.value):i.value)}})],1):e._e()],1)})):t(b.Z,[e._v(" You are currently not authorized. Please log in or register. ")])],2),t(w.Z),t(y.Z,{attrs:{subheader:""}},[t(S.Z,[e._v("Actions")]),t(Z.Z,e._l(e.actions,(function(i){return t(b.Z,{key:i.title,on:{click:i.action}},[t(k.Z,[t(_.Z,{attrs:{"aria-hidden":"true"},domProps:{textContent:e._s(i.icon)}})],1),t(x.V9,{domProps:{textContent:e._s(i.title)}})],1)})),1)],1)],1)],1)],1)},P=[],T=i(6086);let C=null;function $(){return null===C&&(C=(0,T.WB)()),C}var R=i(2482),q=i(9669),A=i.n(q);class E{constructor(e,t=null){(0,R.Z)(this,"client",void 0),t||(t={baseURL:e,timeout:2e3,headers:{"Content-Type":"application/json"}}),this.client=A().create(t)}async genericPostRequest(e,t,i=null){try{const i=await this.client.post(e,{},{params:t});return i.data}catch(o){if(!i)throw o;i(o)}}async genericGetRequest(e,t={},i=null){try{const i=await this.client.get(e,{params:t});return i.data}catch(o){if(!i)throw o;i(o)}}async genericDeleteRequest(e,t={},i=null){try{const i=await this.client.delete(e,{params:t});return i.data}catch(o){if(!i)throw o;i(o)}}convertDateTime(e){const t=e.toISOString().split("T");return t[1]=t[1].split(".")[0],`${t[0]} ${t[1]}`}}const V=36e5;class L extends E{constructor(e){super(e),(0,R.Z)(this,"token",void 0),this.token=null,this.client.interceptors.request.use((e=>(e.headers.Authorization=this.token?`Bearer ${this.token}`:"",e)))}setUnAuthHandler(e=(()=>{})){this.client.interceptors.response.use((e=>e),(t=>{throw 401===t.status&&e(t),t}))}setToken(e){this.token=e}async login(e,t){const i=await this.genericPostRequest("/auth/login",{email:e,password:t},(e=>{if(e.response&&422===e.response.status)throw Object.values(e.response.data.errors).flat()}));return i.data.token}async register(e,t,i){await this.genericPostRequest("/auth/register",{email:e,password:t,name:i},(e=>{if(e.response&&422===e.response.status)throw Object.values(e.response.data.errors).flat()}))}async logout(){return this.genericPostRequest("/auth/logout",{})}async getUserData(){const e=await this.client.get("/user");return e.data.data}async getFiles(e=-1){const t=await this.genericGetRequest("/files",{folder_id:e});return t.data}async getFolders(){const e=await this.genericGetRequest("/folders",{});return e.data}async getFolder(e){const t=await this.genericGetRequest(`/folders/${e}`,{},(e=>{if(e.response&&404===e.response.status)throw"Folder not found"}));return t.data}async createFolder(e){try{const t=await this.genericPostRequest("/folders",{name:e});if(t instanceof q.AxiosError)throw t;return t.data}catch(t){if(t.response&&422===t.response.status)throw Object.values(t.response.data.errors).flat();throw t}}async renameFile(e,t){try{const i=await this.client.patch(`/files/${e}`,{},{params:{name:t}});if(i instanceof q.AxiosError)throw i;return i.data.data}catch(i){if(i.response&&422===i.response.status)throw Object.values(i.response.data.errors).flat()}}async publishFile(e){try{const t=await this.genericPostRequest(`/files/${e}/publish`,{});if(t instanceof q.AxiosError)throw t;return t.data}catch(t){if(t.response&&422===t.response.status)throw Object.values(t.response.data.errors).flat()}}async deleteFile(e){await this.genericDeleteRequest(`/files/${e}`,{},(e=>{if(e.response&&404===e.response.status)throw"File not found. Maybe it has expired?";throw e}))}async uploadFile(e,t=-1,i=null,o=(()=>{})){const r=new FormData;r.append("file",e),-1!==t&&r.append("folder_id",t),i&&r.append("expires_at",this.convertDateTime(i));try{const e=await this.client.post("/files",r,{headers:{"Content-Type":"multipart/form-data"},timeout:V,onUploadProgress:o});if(e instanceof q.AxiosError)throw e;return e.data.data}catch(n){throw n.response&&422===n.response.status?Object.values(n.response.data.errors).flat():n}}async downloadFile(e,t=(()=>{})){try{const i=await this.client.get(`/files/${e.id}/download`,{responseType:"blob",timeout:V,onDownloadProgress:t});if(i instanceof q.AxiosError)throw i;const o=window.URL.createObjectURL(new Blob([i.data])),r=document.createElement("a");r.href=o,r.setAttribute("download",e.full_name),r.click(),r.remove(),window.URL.revokeObjectURL(o)}catch(i){if(i.response&&404===i.response.status)throw"File not found. Maybe it has expired?";throw i}}convertDateTime(e){const t=e.toISOString().split("T");return t[1]=t[1].split(".")[0],`${t[0]} ${t[1]}`}}const I=$();function B(e,t){if("string"===typeof t){let e=/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(([+-]\d\d:\d\d)|Z)?$/i;if(e.test(t))return new Date(t)}return t}function O(e){switch(!0){case e>1e6:return`${(e/1e6).toFixed(2)} MB`;case e>1e3:return`${(e/1e3).toFixed(2)} KB`;default:return`${e} B`}}const N=()=>({name:{value:"",label:"Username"},email:{value:"",label:"Email"},storageInUse:{label:"Storage in use",value:0,formatter:O},storageTotal:{label:"Total storage",value:0,formatter:O},registrationDate:{value:"",label:"Registration date",formatter:e=>e.toLocaleString()},token:{displayable:!1,value:null},preferredFileLayout:{displayable:!1,value:0}});function U(e){return`${e}--user`}function j(e){let t=localStorage.getItem(U(e));if(!t)return N();t=JSON.parse(t,B);const i=N();return Object.keys(t).forEach((e=>{void 0!==i[e].formatter&&(t[e].formatter=i[e].formatter)})),t}function z(e,t){localStorage.setItem(U(e),JSON.stringify(t))}const M=(0,T.Q_)("auth",{state:()=>({userRequestController:new L("http://markwebdev.ru/api/v1"),user:N()}),getters:{isAuthorized:e=>void 0!==e.user?.token.value&&null!==e.user.token.value},actions:{async authenticate(e,t){try{const i=await this.userRequestController.login(e,t);return this.user.token.value=i,this.userRequestController.setToken(i),await this.getUserData(),{success:!0,errors:["Logged in!"]}}catch(i){return{success:!1,errors:i}}},async register(e,t,i){try{return await this.userRequestController.register(e,t,i),{success:!0,errors:["Registered!"]}}catch(o){return{success:!1,errors:o}}},async logout(){await this.userRequestController.logout(),this.clearAuthData()},clearAuthData(){this.user=N(),this.userRequestController.setToken(null)},async getUserData(){try{const e=await this.userRequestController.getUserData();this.user.email.value=e.email,this.user.name.value=e.name,this.user.storageInUse.value=e.storage_size,this.user.storageTotal.value=e.storage_quota,this.user.registrationDate.value=new Date(e.created_at)}catch(e){console.debug(e)}},tryRememberUser(){this.user=j("vue-cloud-storage"),this.user.token.value&&this.userRequestController.setToken(this.user.token.value),this.getUserData()},updateStorageTaken(e){this.user.storageInUse.value+=e},setPreferredFileLayout(e){if(this.user.preferredFileLayout)this.user.preferredFileLayout.value=e;else{const t=N().preferredFileLayout;t.value=e,o.ZP.set(this.user,"preferredFileLayout",t)}}}}),G=M(I);G.userRequestController.setUnAuthHandler((()=>{G.clearAuthData()})),G.tryRememberUser(),G.$subscribe(((e,t)=>z("vue-cloud-storage",t.user)),{detached:!0});var H={name:"UserMenu",setup(){const e=M();return{authStore:e}},methods:{deduplicatedNavigation:function(e){this.$router.currentRoute.path!==e&&this.$router.push(e)}},computed:{actions:function(){let e=null;return e=this.authStore.isAuthorized?[{title:"Logout",icon:"mdi-logout",action:()=>{this.authStore.logout().then((()=>{this.deduplicatedNavigation("/auth")}))}}]:[{title:"Login",icon:"mdi-login",action:()=>{this.deduplicatedNavigation("/auth")}},{title:"Register",icon:"mdi-account-plus",action:()=>{this.deduplicatedNavigation("/register")}}],e}}},K=H,W=i(1001),Y=(0,W.Z)(K,D,P,!1,null,"381bf3fc",null),J=Y.exports,Q={name:"TopBar",components:{UserMenu:J}},X=Q,ee=(0,W.Z)(X,f,h,!1,null,"73ce48a2",null),te=ee.exports,ie={name:"App",components:{TopBar:te,RouterView:a.MA},methods:{toggleDrawer:function(){this.navDrawerShown=!this.navDrawerShown}},data:()=>({navDrawerShown:null})},oe=ie,re=(0,W.Z)(oe,l,s,!1,null,null,null),ne=re.exports,le=i(1858);o.ZP.use(le.Z);var se=new le.Z({}),ae=i(6748),ue=i(4127),ce=i(9256),de=i(9258),pe=i(6313),fe=function(){var e=this,t=e._self._c;return t(ce.Z,[t(pe.Z,[t(p.qW,{domProps:{textContent:e._s(e.currentFolder.name)}}),t(d.Z),t(ae.Z,{attrs:{group:"",mandatory:""},model:{value:e.viewMode,callback:function(t){e.viewMode=t},expression:"viewMode"}},[t(m.Z,[t(_.Z,[e._v(" mdi-format-list-bulleted ")])],1),t(m.Z,[t(_.Z,[e._v(" mdi-dots-grid ")])],1)],1),t(ue.Z,{staticClass:"ml-4",domProps:{textContent:e._s(e.formattedFolderSize)}})],1),e.loaded?t(e.selectedViewLayout,{tag:"component",attrs:{files:e.files,folders:e.folders},on:{delete_file:function(t){return e.deleteFile(t)},download_file:function(t){return e.downloadFile(t)},open_folder:function(t){return e.openFolder(t)},rename_file:function(t){return e.renameFile(t)},publish_file:function(t){return e.publishFile(t)},show_file_dialog:function(t){e.uploadDialogShown=!0}}}):t(e.selectedPreload,{tag:"component"}),t("file-upload-dialog",{attrs:{"folder-id":e.folderId?parseInt(e.folderId):-1},on:{new_file:e.processNewFile},model:{value:e.uploadDialogShown,callback:function(t){e.uploadDialogShown=t},expression:"uploadDialogShown"}}),t("folder-creation-dialog",{on:{new_folder:e.processNewFolder},model:{value:e.creationDialogShown,callback:function(t){e.creationDialogShown=t},expression:"creationDialogShown"}}),t("one-field-dialog",{attrs:{"on-accept":e.auxDialog.action,"accept-action-title":e.auxDialog.actionTitle,"field-label":e.auxDialog.fieldLabel,title:e.auxDialog.title,placeholder:e.auxDialog.placeholder,readonly:e.auxDialog.readonly,"on-show":e.auxDialog.onShow,autofocus:e.auxDialog.autofocus},model:{value:e.auxDialog.shown,callback:function(t){e.$set(e.auxDialog,"shown",t)},expression:"auxDialog.shown"}}),t("floating-controls",{attrs:{actions:e.restrictedControlsActions},on:{show_file_dialog:function(t){e.uploadDialogShown=!0},show_folder_dialog:function(t){e.creationDialogShown=!0}},model:{value:e.controlsExpanded,callback:function(t){e.controlsExpanded=t},expression:"controlsExpanded"}}),t(de.Z,{attrs:{timeout:"2000"},scopedSlots:e._u([{key:"action",fn:function({attrs:i}){return[t(m.Z,e._b({attrs:{color:"primary",text:""},on:{click:function(t){e.error.shown=!1}}},"v-btn",i,!1),[e._v(" Close ")])]}}]),model:{value:e.error.shown,callback:function(t){e.$set(e.error,"shown",t)},expression:"error.shown"}},[e._v(" "+e._s(e.error.text)+" ")])],1)},he=[],me=function(){var e=this,t=e._self._c;return e.files&&e.files.length>0||e.folders&&e.folders.length>0?t("div",[e.folders&&e.folders.length>0?t(y.Z,{attrs:{subheader:""}},[t(S.Z,[e._v("Folders")]),t(Z.Z,{attrs:{value:e.selection.folder},on:{change:function(t){return e.updateSelection("folder",t)}}},e._l(e.folders,(function(i){return t("file-list-item",e._g({key:i.id,attrs:{file:i,type:"folder"}},e.$listeners))})),1)],1):e._e(),t(w.Z),e.files&&e.files.length>0?t(y.Z,{attrs:{subheader:""}},[t(S.Z,[e._v("Files")]),t(Z.Z,{attrs:{value:e.selection.file},on:{change:function(t){return e.updateSelection("file",t)}}},e._l(e.files,(function(i){return t("file-list-item",e._g({key:i.id,attrs:{file:i}},e.$listeners))})),1)],1):e._e()],1):t("no-files-card",e._g({staticClass:"ma-5"},e.$listeners))},ge=[],ve=function(){var e=this,t=e._self._c;return t(g.Z,[t(v.EB,[e._v(" This folder is empty ")]),t(v.ZB,[e._v(" Maybe it's time to upload something? ")]),t(v.h7,[t(m.Z,{attrs:{plain:"",color:"primary"},on:{click:function(t){return t.stopPropagation(),e.$emit("show_file_dialog")}}},[e._v(" Upload file ")])],1)],1)},we=[],_e={name:"NoFilesCard"},ye=_e,be=(0,W.Z)(ye,ve,we,!1,null,"545dd9ef",null),xe=be.exports,Ze=i(5187),ke=i(2450),Fe=i(9592),Se=function(){var e=this,t=e._self._c;return t(b.Z,[t(ke.Z,[t(_.Z,[e._v(e._s(e.fileType.icon))])],1),t(x.km,[t(x.V9,{staticClass:"file-list-item__title"},[e._v(" "+e._s(e.file.name)+" "),e.file.public_url?t(ue.Z,{attrs:{color:"primary","x-small":""}},[e._v(" Public ")]):e._e(),e.file.expires_at?t(ue.Z,{attrs:{color:"warning","x-small":""}},[e._v(" Temp ")]):e._e()],1),e.file.is_downloading?t(x.oZ,[t(Fe.Z,{attrs:{value:e.progress}})],1):t(x.oZ,[e._v(" "+e._s(e.date)+" ")])],1),t(Ze.Z,{staticClass:"file-list-item__actions"},["Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:"",disabled:e.file.is_downloading},on:{click:function(t){return t.stopPropagation(),e.download.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-download")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.renameFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-pencil")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.publishFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-share-variant")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:"",disabled:e.file.is_downloading},on:{click:function(t){return t.stopPropagation(),e.deleteFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"red lighten-2"}},[e._v("mdi-delete")])],1):e._e()],1)],1)},De=[];const Pe=[{type:"Image",regex:/jpe?g|a?png|kra|gif|psd|tiff|avif|webp|bmp|ico/i,icon:"mdi-file-image"},{type:"Video",regex:/avi|mpe?g|mkv|m4v/i,icon:"mdi-file-video"},{type:"Audio",regex:/mp3|m4a|flac|alac|wav/i,icon:"mdi-file-music"},{type:"Archive",regex:/zipp?|rar|tar|gz/i,icon:"mdi-zip-box"},{type:"Text",regex:/txt|rtf|md/i,icon:"mdi-file-document-outline"},{type:"Document",regex:/docx?|odf|odt|pages/i,icon:"mdi-file-document"},{type:"PDF",regex:/pdf/i,icon:"mdi-file-pdf-box"},{type:"Table",regex:/xlsx?|ods|csv/i,icon:"mdi-file-table"},{type:"Code",regex:/c(pp)?|h(pp)?|jsx?|tsx?|pyc?/i,icon:"mdi-file-code"},{type:"Folder",regex:/folder/i,icon:"mdi-folder"},{type:"Unknown",regex:/.*/i,icon:"mdi-file-question"}],Te={props:{type:{type:String,default:"file"},file:{type:Object,required:!0}},methods:{showInformation:function(){this.$emit("show_information",this.file,this.fileType)},download:function(){this.$emit("download_file",this.file)},deleteFile:function(){this.$emit("delete_file",this.file)},renameFile:function(){this.$emit("rename_file",this.file)},publishFile:function(){this.$emit("publish_file",this.file)},getExtension:function(e){const t=e.split(".");return t.length>1?t.pop():""}},computed:{fileType:function(){const e="folder"===this.type?"folder":this.getExtension(this.file.full_name);return Pe.find((t=>t.regex.test(e)))},date:function(){return-1===this.file.id?"":this.file.updated_at?this.file.updated_at.toLocaleString():this.file.created_at.toLocaleString()},progress:function(){return this.file.is_downloading?0===this.file.download_total?0:Math.round(this.file.download_progress/this.file.download_total*100):0}}};var Ce=Te,$e={name:"FileListItem",mixins:[Ce]},Re=$e,qe=(0,W.Z)(Re,Se,De,!1,null,"4ae85070",null),Ae=qe.exports;const Ee={data:()=>({selection:{folder:null,file:null}}),props:{files:Array,folders:Array},methods:{updateSelection:function(e,t){Object.keys(this.selection).filter((t=>t!==e)).forEach((e=>this.selection[e]=null)),this.selection[e]=t,"folder"===e&&void 0!==t&&(this.$emit("open_folder",this.folders[this.selection[e]]),this.selection[e]=null)}}};var Ve=Ee,Le={name:"FileListView",components:{NoFilesCard:xe,FileListItem:Ae},mixins:[Ve]},Ie=Le,Be=(0,W.Z)(Ie,me,ge,!1,null,"4bd9bdc9",null),Oe=Be.exports,Ne=function(){var e=this,t=e._self._c;return e.files&&e.files.length>0||e.folders&&e.folders.length>0?t("div",{staticClass:"file-grid-view"},[e._l(e.folders,(function(i,o){return t("file-grid-item",e._g({key:i.id,attrs:{file:i,type:"folder",selected:e.selection.folder===o},on:{click:function(t){return e.updateSelection("folder",o)}}},e.$listeners))})),e._l(e.files,(function(i,o){return t("file-grid-item",e._g({key:i.id,attrs:{file:i,selected:e.selection.folder===o},on:{click:function(t){return e.updateSelection("file",o)}}},e.$listeners))}))],2):t("no-files-card",e._g({staticClass:"ma-5"},e.$listeners))},Ue=[],je=i(8242),ze=function(){var e=this,t=e._self._c;return t(g.Z,{staticClass:"file-grid-item",on:{click:function(t){return e.$emit("click")}}},[t(_.Z,{attrs:{size:"100"}},[e._v(" "+e._s(e.fileType.icon)+" ")]),t(v.EB,{staticClass:"file-grid-item__title"},[e._v(" "+e._s(e.shortenedName)+" "),t(je.Z,[e.file.public_url?t(ue.Z,{attrs:{color:"primary","x-small":""}},[e._v(" Public ")]):e._e(),e.file.expires_at?t(ue.Z,{attrs:{color:"warning","x-small":""}},[e._v(" Temp ")]):e._e()],1)],1),e.file.is_downloading?t(v.ZB,[t(Fe.Z,{attrs:{value:e.progress}})],1):t(v.ZB,{staticClass:"file-grid-item__text"},[e._v(" "+e._s(e.date)+" ")]),t(d.Z),t(v.h7,["Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:"",disabled:e.file.is_downloading},on:{click:function(t){return t.stopPropagation(),e.download.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-download")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.renameFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-pencil")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.publishFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"grey lighten-1"}},[e._v("mdi-share-variant")])],1):e._e(),"Folder"!==e.fileType.type?t(m.Z,{attrs:{icon:"",disabled:e.file.is_downloading},on:{click:function(t){return t.stopPropagation(),e.deleteFile.apply(null,arguments)}}},[t(_.Z,{attrs:{color:"red lighten-2"}},[e._v("mdi-delete")])],1):e._e()],1)],1)},Me=[],Ge={name:"FileGridItem",mixins:[Ce],computed:{shortenedName:function(){let e=this.file.name.slice(0,30);return e.length<this.file.name.length&&(e+="..."),e}}},He=Ge,Ke=(0,W.Z)(He,ze,Me,!1,null,"5db093f4",null),We=Ke.exports,Ye={name:"FileGridView",mixins:[Ve],components:{FileGridItem:We,NoFilesCard:xe}},Je=Ye,Qe=(0,W.Z)(Je,Ne,Ue,!1,null,"62368f54",null),Xe=Qe.exports,et=i(4978),tt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"preload-list"},e._l(10,(function(e){return t(et.Z,{key:e,staticClass:"preload-list__loader",attrs:{type:"avatar, text@2, button"}})})),1)},it=[],ot={name:"PreloadListView"},rt=ot,nt=(0,W.Z)(rt,tt,it,!1,null,"51f81794",null),lt=nt.exports,st=function(){var e=this,t=e._self._c;return t("div",{staticClass:"preload-grid"},e._l(10,(function(e){return t(et.Z,{key:e,attrs:{type:"card, actions"}})})),1)},at=[],ut={name:"PreloadGridView"},ct=ut,dt=(0,W.Z)(ct,st,at,!1,null,"5ec6e734",null),pt=dt.exports,ft=i(3694),ht=i(3486),mt=i(4061),gt=i(2953),vt=i(5125),wt=function(){var e=this,t=e._self._c;return t(mt.Z,{attrs:{value:e.isShown,persistent:e.locked},on:{input:function(t){return e.$emit("toggleVisibility",t)}}},[t(g.Z,[e.upload.inProgress?t(Fe.Z,{attrs:{absolute:"",top:"",value:e.uploadProgress,color:"primary"}}):e._e(),t(v.EB,[e._v("Upload file")]),t(v.ZB,[e._l(e.alerts,(function(i,o){return t(ft.Z,{key:o,attrs:{color:"warning"},domProps:{textContent:e._s(i)}})})),t(vt.Z,{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(gt.Z,{attrs:{"show-size":"",label:"File to upload",rules:e.rules,required:""},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),t(ht.Z,{attrs:{label:"Temporary file"},model:{value:e.fileExpires,callback:function(t){e.fileExpires=t},expression:"fileExpires"}}),e.fileExpires?[t("date-input",{attrs:{min:new Date},model:{value:e.expire.date,callback:function(t){e.$set(e.expire,"date",t)},expression:"expire.date"}}),t("time-input",{model:{value:e.expire.time,callback:function(t){e.$set(e.expire,"time",t)},expression:"expire.time"}})]:e._e()],2)],2),t(v.h7,[t(d.Z),t(m.Z,{attrs:{plain:"",disabled:e.locked},on:{click:function(t){return t.stopPropagation(),e.closeDialog.apply(null,arguments)}}},[e._v(" Cancel ")]),t(m.Z,{attrs:{plain:"",color:"primary",disabled:e.locked||!e.valid},on:{click:function(t){return t.stopPropagation(),e.uploadFile.apply(null,arguments)}}},[e._v(" Upload ")])],1)],1)],1)},_t=[],yt=i(7778),bt=i(8704),xt=function(){var e=this,t=e._self._c;return t(F.Z,{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:o}){return[t(bt.Z,e._g(e._b({attrs:{label:"Expire date","prepend-icon":"mdi-calendar",value:e.value.toLocaleDateString(),readonly:""}},"v-text-field",o,!1),i))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[t(yt.Z,{attrs:{"no-title":"",min:e.min?e.min.toISOString():void 0,max:e.max?e.max.toISOString():void 0,value:e.value.toISOString()},on:{input:function(t){e.$emit("input",new Date(t))}}})],1)},Zt=[],kt={name:"DateInput",props:{value:Date,min:Date,max:Date},data:()=>({menu:!1})},Ft=kt,St=(0,W.Z)(Ft,xt,Zt,!1,null,"442c694c",null),Dt=St.exports,Pt=i(9580),Tt=function(){var e=this,t=e._self._c;return t(F.Z,{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:o}){return[t(bt.Z,e._g(e._b({attrs:{label:"Expire time","prepend-icon":"mdi-clock-time-four-outline",value:e.value.toLocaleTimeString(),readonly:""}},"v-text-field",o,!1),i))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e.menu?t(Pt.Z,{attrs:{"no-title":"",format:"24hr",value:e.time},on:{input:e.emitTime,"click:minute":function(t){e.menu=!1}}}):e._e()],1)},Ct=[],$t={name:"TimeInput",props:{value:Date},data:()=>({menu:!1,innerTime:new Date(0)}),computed:{time:function(){return`${this.value.getHours().toString().padStart(2,"0")}:${this.value.getMinutes().toString().padStart(2,"0")}`}},methods:{emitTime:function(e){const[t,i]=e.split(":").map((e=>parseInt(e))),o=new Date(this.innerTime.getTime());Number.isNaN(t)||o.setHours(t),Number.isNaN(i)||o.setMinutes(i),this.$emit("input",o)}}},Rt=$t,qt=(0,W.Z)(Rt,Tt,Ct,!1,null,"2a5da4ca",null),At=qt.exports;function Et(e){const t=e.split(".");return t.length>1?t.pop():""}var Vt={name:"FileUploadDialog",components:{TimeInput:At,DateInput:Dt},setup(){const e=M();return{authStore:e}},model:{prop:"isShown",event:"toggleVisibility"},props:{isShown:Boolean,folderId:Number},data:()=>({rules:[e=>!!e||"File must be selected",e=>!e||e.size<2e7||"File size must not exceed 20MB!",e=>!e||"php"!==Et(e.name)||"File must not be .php"],valid:!1,file:null,fileExpires:!1,alerts:[],expire:{date:new Date,time:new Date},locked:!1,upload:{inProgress:!1,progress:0,total:0}}),methods:{uploadFile:async function(){if(this.alerts=[],!this.fileExpires||this.validateExpireTime()){this.file||this.alerts.push("File must be selected."),this.locked=!0,this.upload.inProgress=!0;try{const e=await this.authStore.userRequestController.uploadFile(this.file,this.folderId,this.fileExpires?this.expireDateTime:null,(e=>{this.upload.progress=e.loaded,this.upload.total=e.total}));this.$emit("new_file",e),this.closeDialog()}catch(e){if(console.log(e),!Array.isArray(e))throw"An unexpected error occured while handling upload errors";this.alerts.push(...e)}finally{this.upload.inProgress=!1,this.locked=!1}}else this.alerts.push("File cannot expire before upload. Please select different date-time.")},closeDialog:function(){this.reset(),this.$emit("toggleVisibility",!1)},reset:function(){this.file=null,this.fileExpires=!1},validateExpireTime:function(){return this.expireDateTime>new Date}},computed:{expireDateTime:function(){const e=new Date(this.expire.date);return e.setHours(this.expire.time.getHours()),e.setMinutes(this.expire.time.getMinutes()),e},uploadProgress:function(){return this.upload.inProgress?Math.round(this.upload.progress/this.upload.total*100):0}}},Lt=Vt,It=(0,W.Z)(Lt,wt,_t,!1,null,"2dc9b356",null),Bt=It.exports,Ot=i(7394),Nt=i(2356),Ut=function(){var e=this,t=e._self._c;return e.actions.length>1?t(Nt.Z,{attrs:{value:e.controlsExpanded,transition:"slide-y-reverse-transition",fixed:"",bottom:"",right:"",direction:"top"},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"activator",fn:function(){return[t(Ot.b0,[t(m.Z,{attrs:{color:"primary",bottom:"",right:"",fab:""}},[e.controlsExpanded?t(_.Z,[e._v(" mdi-close ")]):t(_.Z,[e._v(" mdi-plus ")])],1)],1)]},proxy:!0}],null,!1,2647995920)},e._l(e.actions,(function(i){return t(m.Z,{key:i.name,attrs:{fab:"",dark:"",small:"",color:i.color},on:{click:function(t){return e.$emit(i.event)}}},[t(_.Z,{domProps:{textContent:e._s(i.icon)}})],1)})),1):t(Ot.b0,[t(m.Z,{attrs:{color:e.actions[0].color,fixed:"",bottom:"",right:"",dark:"",fab:""},on:{click:function(t){return e.$emit(e.actions[0].event)}}},[t(_.Z,{domProps:{textContent:e._s(e.actions[0].icon)}})],1)],1)},jt=[],zt={name:"FloatingControls",model:{prop:"controlsExpanded"},props:{controlsExpanded:Boolean,actions:{type:Array,required:!0,validator:function(e){return e.length>0}}}},Mt=zt,Gt=(0,W.Z)(Mt,Ut,jt,!1,null,"e73231b4",null),Ht=Gt.exports,Kt=function(){var e=this,t=e._self._c;return t(mt.Z,{attrs:{value:e.isShown,persistent:e.locked},on:{input:function(t){return e.$emit("toggleVisibility",t)}}},[t(g.Z,[t(v.EB,[e._v("Create folder")]),t(v.ZB,[t(vt.Z,{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e._l(e.alerts,(function(i,o){return t(ft.Z,{key:o,attrs:{color:"warning"},domProps:{textContent:e._s(i)}})})),t(bt.Z,{attrs:{label:"Folder name",rules:e.rules,required:""},model:{value:e.folderName,callback:function(t){e.folderName=t},expression:"folderName"}})],2)],1),t(v.h7,[t(d.Z),t(m.Z,{attrs:{plain:"",disabled:e.locked},on:{click:function(t){return t.stopPropagation(),e.closeDialog.apply(null,arguments)}}},[e._v(" Cancel ")]),t(m.Z,{attrs:{plain:"",color:"primary",disabled:e.locked||!e.valid},on:{click:function(t){return t.stopPropagation(),e.createFolder.apply(null,arguments)}}},[e._v(" Create ")])],1)],1)],1)},Wt=[],Yt={name:"FolderCreationDialog",setup(){const e=M();return{authStore:e}},model:{prop:"isShown",event:"toggleVisibility"},props:{isShown:Boolean,folderId:Number},data:()=>({rules:[e=>!!e],valid:!1,alerts:[],folderName:"",locked:!1}),methods:{closeDialog:function(){this.reset(),this.$emit("toggleVisibility",!1)},createFolder:async function(){this.locked=!0,this.alerts=[];try{const e=await this.authStore.userRequestController.createFolder(this.folderName);this.$emit("new_folder",e),this.closeDialog()}catch(e){if(!Array.isArray(e))throw"An unexpected error occured while handling folder creation errors";this.alerts.push(...e)}finally{this.locked=!1}},reset:function(){this.folderName=""}}},Jt=Yt,Qt=(0,W.Z)(Jt,Kt,Wt,!1,null,"3f53a010",null),Xt=Qt.exports,ei=function(){var e=this,t=e._self._c;return t(mt.Z,{attrs:{value:e.isShown,persistent:e.locked},on:{input:function(t){return e.$emit("toggleVisibility",t)}}},[t(g.Z,[e.progress&&e.progress.inProgress?t(Fe.Z,{attrs:{value:e.progressPercent}}):e._e(),t(v.EB,{domProps:{textContent:e._s(e.title)}}),t(v.ZB,[t(vt.Z,{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e._l(e.alerts,(function(i,o){return t(ft.Z,{key:o,attrs:{color:"warning"},domProps:{textContent:e._s(i)}})})),t(bt.Z,{attrs:{label:e.fieldLabel,rules:e.rules,placeholder:e.placeholder,required:"",readonly:e.readonly,autofocus:e.autofocus},model:{value:e.fieldValue,callback:function(t){e.fieldValue=t},expression:"fieldValue"}})],2)],1),t(v.h7,[t(d.Z),t(m.Z,{attrs:{plain:"",disabled:e.locked},on:{click:function(t){return t.stopPropagation(),e.closeDialog.apply(null,arguments)}}},[e._v(" Cancel ")]),t(m.Z,{attrs:{plain:"",color:"primary",disabled:e.locked||!e.valid},domProps:{textContent:e._s(e.acceptActionTitle??"Accept")},on:{click:function(t){t.stopPropagation(),e.onAccept?e.onAccept(e.fieldValue,e.alerts,e.closeDialog):e.closeDialog()}}})],1)],1)],1)},ti=[],ii={name:"OneFieldDialog",setup(){const e=M();return{authStore:e}},model:{prop:"isShown",event:"toggleVisibility"},props:{isShown:{type:Boolean,required:!0},onShow:{type:Function,required:!1},onAccept:{type:Function,required:!1},acceptActionTitle:String,title:{type:String,required:!0},fieldLabel:String,placeholder:String,readonly:Boolean,autofocus:Boolean},data:()=>({rules:[e=>!!e],valid:!1,alerts:[],fieldValue:"",locked:!1,progress:{inProgress:!1,progress:0,total:0}}),methods:{closeDialog:function(){this.reset(),this.$emit("toggleVisibility",!1)},reset:function(){this.locked=!1,this.alerts=[],this.fieldValue=""}},computed:{progressPercent:function(){return void 0===this.progress||!1===this.progress.inProgress?0:Math.round(this.progress.progress/this.progress.total*100)}},watch:{isShown:function(e,t){this.onShow&&!t&&e&&this.onShow(this)}}},oi=ii,ri=(0,W.Z)(oi,ei,ti,!1,null,"31e5147e",null),ni=ri.exports,li={name:"FileView",setup(){const e=M();return{authStore:e}},props:{folderId:{type:String,default:"-1"}},data:()=>({loaded:!1,uploadDialogShown:!1,creationDialogShown:!1,viewMode:null,auxDialog:{shown:!1,action:void 0,onShow:void 0,readonly:!1,actionTitle:void 0,fieldLabel:"",title:"",placeholder:"",autofocus:!0},currentFolder:{name:"/",size:0},error:{shown:!1,text:""},controlsExpanded:!1,controlsActions:[{name:"uploadFile",icon:"mdi-file-plus",event:"show_file_dialog",color:"green"},{name:"createFolder",icon:"mdi-folder-plus",event:"show_folder_dialog",color:"blue"}],files:[],folders:[],timers:[]}),computed:{selectedViewLayout:function(){const e=["FileListView","FileGridView"];return this.authStore.setPreferredFileLayout(this.viewMode),e[this.viewMode]},selectedPreload:function(){const e=["PreloadListView","PreloadGridView"];return e[this.viewMode]},formattedFolderSize:function(){return O(this.currentFolder.size)},restrictedControlsActions:function(){return-1===parseInt(this.folderId)?this.controlsActions:[this.controlsActions.find((e=>"uploadFile"===e.name))]}},methods:{renameFile:function(e){this.auxDialog.actionTitle="Rename",this.auxDialog.fieldLabel="New name",this.auxDialog.placeholder=e.name,this.auxDialog.readonly=!1,this.auxDialog.onShow=void 0,this.auxDialog.title="Rename file",this.auxDialog.action=async(t,i,o)=>{try{const i=await this.authStore.userRequestController.renameFile(e.id,t);e.name=i.name,e.full_name=i.full_name,o()}catch(r){if(!Array.isArray(r))throw"Unknown error encountered during renaming file";i.push(...r)}},this.auxDialog.shown=!0},publishFile:function(e){this.auxDialog.actionTitle="Ok",this.auxDialog.fieldLabel="Share link",this.auxDialog.placeholder="",this.auxDialog.action=void 0,this.auxDialog.readonly=!0,this.auxDialog.title="Your public file link:",this.auxDialog.onShow=async t=>{t.progress.inProgress=!0;try{let i=null;if(!e.public_url){const t=await this.authStore.userRequestController.publishFile(e.id);i=this.buildProxyLink(t.link),e.public_url=i}t.fieldValue=e.public_url}catch(i){t.alerts.push(...i)}t.progress.inProgress=!1},this.auxDialog.shown=!0},deleteFile:async function(e){if(e.is_downloading)return;const t=await this.$confirm(`Do you really want to delete ${e.name}?`,{title:"Delete file",color:"primary",icon:"mdi-help"});if(!0===t)try{await this.authStore.userRequestController.deleteFile(e.id),this.removeFileFromView(e)}catch(i){this.error.text=i.toString(),this.error.shown=!0,this.removeFileFromView(e)}},downloadFile:function(e){e.is_downloading||(e.is_downloading=!0,this.authStore.userRequestController.downloadFile(e,(t=>{e.download_progress=t.loaded,e.download_total=t.total})).then((()=>{e.is_downloading=!1,e.download_total=0,e.download_progress=0})).catch((t=>{this.error.text=t.toString(),this.error.shown=!0,this.removeFileFromView(e)})))},openFolder:function(e){this.$router.push(`/${e.id}`)},processNewFile:function(e){this.files.push(e),this.transformFile(this.files[this.files.length-1]),this.updateStorage(e.size)},processNewFolder:function(e){this.folders.push(e),this.transformFolder(this.folders[this.folders.length-1])},updateStorage:function(e){this.authStore.updateStorageTaken(e),-1!==this.folderId&&(this.currentFolder.size+=e)},removeFileFromView:function(e){this.files=this.files.filter((t=>t.id!==e.id)),this.updateStorage(-e.size)},transformFile:function(e){e.expires_at=e.expires_at?new Date(e.expires_at):null,e.expires_at&&this.setRemovalTimer(e),e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.public_url&&(e.public_url=this.buildProxyLink(e.public_url)),this.$set(e,"is_downloading",!1),this.$set(e,"download_progress",0),this.$set(e,"download_total",0)},setRemovalTimer:function(e){const t=e.expires_at-new Date,i=setTimeout((()=>{this.files.includes(e)&&(this.removeFileFromView(e),this.error.text=`Removed file ${e.name}: expired`,this.error.shown=!0)}),t);this.timers.push(i)},transformFolder:function(e){e.created_at=new Date(e.created_at)},buildProxyLink:function(e){const t=e.split("/").pop(),i=this.$router.resolve(`/download/${t}`),o=`${window.location.origin}${window.location.pathname}`;return`${o}${i.href}`},loadData:async function(e){if("-1"!==e)try{this.currentFolder=await this.authStore.userRequestController.getFolder(e)}catch(t){return void this.$router.push("/")}else this.currentFolder={name:"/",size:this.authStore.user.storageInUse.value};[this.files,this.folders]=await Promise.all([this.authStore.userRequestController.getFiles(e),-1===Number(e)?this.authStore.userRequestController.getFolders():[{id:-1,name:".."}]]),this.files.forEach(this.transformFile),this.folders.forEach(this.transformFolder),this.loaded=!0},clearTimers:function(){this.timers.forEach((e=>clearTimeout(e)))}},components:{OneFieldDialog:ni,FolderCreationDialog:Xt,FloatingControls:Ht,FileUploadDialog:Bt,PreloadListView:lt,PreloadGridView:pt,FileGridView:Xe,FileListView:Oe},beforeMount:async function(){this.authStore.user.preferredFileLayout&&(this.viewMode=this.authStore.user.preferredFileLayout.value),await this.loadData(this.folderId)},beforeRouteUpdate:async function(e,t,i){e.name===t.name&&e.params.folderId!==t.params.folderId?(this.clearTimers(),await this.loadData(e.params.folderId??"-1"),i()):i()},beforeRouteLeave(e,t,i){e.name!==t.name&&this.clearTimers(),i()}},si=li,ai=(0,W.Z)(si,fe,he,!1,null,null,null),ui=ai.exports,ci=i(266),di=i(1713),pi=function(){var e=this,t=e._self._c;return t(ce.Z,{attrs:{"fill-height":""}},[t(di.Z,{attrs:{align:"center",justify:"center"}},[t(ci.Z,{attrs:{cols:"6"}},[t(g.Z,[t(v.EB,[e._v("Log in")]),t(v.ZB,[t(vt.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.alert?e._l(e.alert.errors,(function(i,o){return t(ft.Z,{key:o,attrs:{dense:"",type:e.alert.success?"success":"warning"}},[e._v(" "+e._s(i)+" ")])})):e._e(),t(bt.Z,{staticClass:"input--fix-autofill",attrs:{label:"Email",rules:e.validation.emailRules,required:""},model:{value:e.login,callback:function(t){e.login=t},expression:"login"}}),t(bt.Z,{staticClass:"input--fix-autofill",attrs:{label:"Password",rules:e.validation.fieldRules,"append-icon":e.passwordVisible?"mdi-eye":"mdi-eye-off",type:e.passwordVisible?"text":"password",required:""},on:{"click:append":function(t){e.passwordVisible=!e.passwordVisible}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],2)],1),t(v.h7,[t(m.Z,{attrs:{loading:e.loading,plain:"",color:"primary",disabled:!e.valid},on:{click:e.authenticate}},[e._v(" Log in ")]),t(m.Z,{ref:"regBtn",attrs:{loading:e.loading,plain:""},on:{click:e.navigateToRegistration}},[e._v(" Register ")])],1)],1)],1)],1)],1)},fi=[],hi={name:"AuthView",computed:{...(0,T.Kc)(M)},data:()=>({valid:!1,passwordVisible:!1,login:"",password:"",alert:null,loading:!1,validation:{fieldRules:[e=>!!e||"Field is required"],emailRules:[e=>!!e||"E-mail is required",e=>/.+@.+\..+/.test(e)||"E-mail must be valid"]}}),methods:{authenticate:async function(){this.loading=!0;const e=await this.authStore.authenticate(this.login,this.password);this.loading=!1,e.success?(this.alert=null,this.$router.push("/")):this.alert=e},navigateToRegistration:function(){this.$router.push("/register")}},mounted(){setTimeout((()=>{const e=document.querySelectorAll("input:-webkit-autofill");e.forEach((e=>{const t=e.parentElement.querySelector("label");t.classList.add("v-label--active")}))}),100)}},mi=hi,gi=(0,W.Z)(mi,pi,fi,!1,null,"895fb25e",null),vi=gi.exports,wi=function(){var e=this,t=e._self._c;return t(ce.Z,{attrs:{"fill-height":""}},[t(di.Z,{attrs:{align:"center",justify:"center"}},[t(ci.Z,{attrs:{cols:"6"}},[t(g.Z,[t(v.EB,[e._v("Register")]),t(v.ZB,[t(vt.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.alert?e._l(e.alert.errors,(function(i,o){return t(ft.Z,{key:o,attrs:{dense:"",type:e.alert.success?"success":"warning"}},[e._v(" "+e._s(i)+" ")])})):e._e(),t(bt.Z,{staticClass:"input--fix-autofill",attrs:{label:"User name",rules:e.validation.fieldRules,required:"",autocomplete:"login"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(bt.Z,{staticClass:"input--fix-autofill",attrs:{label:"Email",rules:e.validation.emailRules,required:"",autocomplete:"email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t(bt.Z,{staticClass:"input--fix-autofill",attrs:{label:"Password",rules:e.validation.fieldRules,"append-icon":e.passwordVisible?"mdi-eye":"mdi-eye-off",type:e.passwordVisible?"text":"password",required:"",autocomplete:"password"},on:{"click:append":function(t){e.passwordVisible=!e.passwordVisible}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],2)],1),t(v.h7,[t(m.Z,{attrs:{loading:e.loading,plain:"",color:"primary",disabled:!e.valid},on:{click:e.register}},[e._v(" Register ")])],1)],1)],1)],1)],1)},_i=[],yi={name:"RegisterView",computed:{...(0,T.Kc)(M)},data:()=>({valid:!1,passwordVisible:!1,name:"",email:"",password:"",alert:null,loading:!1,validation:{fieldRules:[e=>!!e||"Field is required"],emailRules:[e=>!!e||"E-mail is required",e=>/.+@.+\..+/.test(e)||"E-mail must be valid"]}}),methods:{register:async function(){this.loading=!0;const e=await this.authStore.register(this.email,this.password,this.name);if(e.success){this.alert=e;const t=await this.authStore.authenticate(this.email,this.password);t.success?(this.alert=null,this.$router.push("/")):this.alert={success:!1,errors:["Autologin failed",...t.errors]}}else this.alert=e;this.loading=!1}},mounted(){setTimeout((()=>{const e=document.querySelectorAll("input:-webkit-autofill");e.forEach((e=>{const t=e.parentElement.querySelector("label");t.classList.add("v-label--active")}))}),100)}},bi=yi,xi=(0,W.Z)(bi,wi,_i,!1,null,"d0bbb66e",null),Zi=xi.exports,ki=function(){var e=this,t=e._self._c;return t(ce.Z,[t(g.Z,[t(v.EB,[e._v("Public file download")]),t(v.ZB,[t("p",[e._v(" Your file download should have been started. ")])]),t(v.h7,[e.authStore.isAuthorized?t(m.Z,{attrs:{plain:""},on:{click:e.toFiles}},[e._v(" Go to files ")]):e._e(),t(d.Z),t(m.Z,{attrs:{plain:"",color:"primary"},on:{click:e.downloadFile}},[e._v(" Retry ")])],1)],1)],1)},Fi=[];class Si extends E{downloadPublicFile(e){const t=`${this.client.getUri()}/downloads/${e}`;console.log(t);try{window.open(t)}catch(i){console.log(i)}}}var Di={name:"PublicDownloadView",setup(){const e=M();return{authStore:e}},props:{uuid:String},methods:{downloadFile:function(){const e=new Si("http://markwebdev.ru/api/v1");e.downloadPublicFile(this.uuid)},toFiles:function(){this.authStore.isAuthorized?this.$router.push("/"):this.$router.push("/auth")}},mounted(){this.downloadFile()}},Pi=Di,Ti=(0,W.Z)(Pi,ki,Fi,!1,null,"81af8f1e",null),Ci=Ti.exports;o.ZP.use(a.ZP);const $i=[{path:"/auth",name:"Auth",component:vi},{path:"/register",name:"Register",component:Zi},{path:"/about",name:"about",component:()=>i.e(443).then(i.bind(i,1272))},{path:"/download/:uuid",name:"Public download",component:Ci,props:!0},{path:"/:folderId?",name:"Files",component:ui,props:!0,meta:{requiresAuth:!0}}],Ri=new a.ZP({routes:$i});Ri.beforeEach(((e,t,i)=>{if(e.matched.some((e=>e.meta.requiresAuth))){const t=M();t.isAuthorized?i():i({path:"/auth",query:{redirect:e.fullPath}})}else i()})),M().$subscribe(((e,t)=>{null==t.user.token.value&&"Auth"!==Ri.currentRoute.name&&Ri.push("/auth")}));var qi=Ri,Ai=i(8087),Ei=i.n(Ai);o.ZP.config.productionTip=!1,o.ZP.use(T.og),o.ZP.use(Ei(),{vuetify:se});const Vi=$();new o.ZP({vuetify:se,router:qi,pinia:Vi,render:e=>e(ne)}).$mount("#app")},9574:function(e,t,i){e.exports=i.p+"img/logo.4d6033c9.svg"}},t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,o,r,n){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],n=e[c][2];for(var s=!0,a=0;a<o.length;a++)(!1&n||l>=n)&&Object.keys(i.O).every((function(e){return i.O[e](o[a])}))?o.splice(a--,1):(s=!1,n<l&&(l=n));if(s){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,r,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,o){return i.f[o](e,t),t}),[]))}}(),function(){i.u=function(e){return"js/about.7bd002e3.js"}}(),function(){i.miniCssF=function(e){}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="vue-cloud-storage:";i.l=function(o,r,n,l){if(e[o])e[o].push(r);else{var s,a;if(void 0!==n)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){s=d;break}}s||(a=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+n),s.src=o),e[o]=[r];var p=function(t,i){s.onerror=s.onload=null,clearTimeout(f);var r=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(i)})),t)return t(i)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),a&&document.head.appendChild(s)}}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p=""}(),function(){var e={143:0};i.f.j=function(t,o){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var n=new Promise((function(i,o){r=e[t]=[i,o]}));o.push(r[2]=n);var l=i.p+i.u(t),s=new Error,a=function(o){if(i.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var n=o&&("load"===o.type?"missing":o.type),l=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+l+")",s.name="ChunkLoadError",s.type=n,s.request=l,r[1](s)}};i.l(l,a,"chunk-"+t,t)}},i.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,n,l=o[0],s=o[1],a=o[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(a)var c=a(i)}for(t&&t(o);u<l.length;u++)n=l[u],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(c)},o=self["webpackChunkvue_cloud_storage"]=self["webpackChunkvue_cloud_storage"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(2462)}));o=i.O(o)})();
//# sourceMappingURL=app.6b11a700.js.map